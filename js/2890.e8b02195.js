(self["webpackChunkShmily"]=self["webpackChunkShmily"]||[]).push([[2890],{2890:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return J}});var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"modify-msg",class:[{isModify:t.isModify},t.modifyType],attrs:{title:"增删改查 Msg 内容, 按 Ctrl 点击可以快速 delete"},on:{click:function(e){return e.ctrlKey?t.modifyMsg("delete"):null}}},[s("el-popover",{attrs:{"popper-class":"EditMsgBox"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[t.visible?s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"wrap"},[s("div",{staticClass:"btns"},[s("div",{staticClass:"left"},[s("el-button",{staticClass:"left",attrs:{plain:t.msgIsNotModify,type:"success"},on:{click:function(e){return t.initMsgEdit()}}},[t._v("重置")]),""!=t.msgText?s("el-button",{staticClass:"left",attrs:{type:"warning"},on:{click:function(e){t.msgText=""}}},[t._v("清空")]):t._e(),s("el-button",{staticClass:"left",attrs:{title:"交换发件人和收件人",type:"info"},on:{click:function(e){return t.msgChangeDirection()}}},[t._v("交换")]),s("el-button",{staticClass:"left",attrs:{disabled:!t.canDel,loading:t.loading,type:"danger"},on:{click:function(e){return t.modifyMsg("delete")}}},[t._v("删除")]),s("el-button",{staticClass:"left",attrs:{disabled:!t.msgIsNotModify,title:"修改后的HTML无法更新文件,如需更新文件请请重置",type:"info"},on:{click:function(e){t.updateByFileShow=!0}}},[t._v("文件")])],1),s("div",{staticClass:"center"},[t._v(" 注意 "),s("code",[t._v("html(仅显示)")]),t._v(" 和 "),s("code",[t._v("content(仅搜索)")]),t._v(" 属性的区别 ")]),s("div",{staticClass:"right"},[s("el-button",{attrs:{type:"text"},on:{click:function(e){t.visible=!1}}},[t._v("取消")]),s("el-button",{attrs:{disabled:!(t.isMsgParseOk&&t.canModify),loading:t.loading,type:"primary"},on:{click:function(e){return t.modifyMsg("modify")}}},[t._v("修改")])],1)]),s("hr"),t.updateByFileShow?t._e():[s("MsgHtmlInput",{attrs:{canDel:t.canDel,msg:t.msg,msgModify:t.msgModify,show:t.visible,text:t.msgText},on:{"update:text":function(e){t.msgText=e}}}),t.canDel?[s("el-checkbox",{attrs:{title:"只会删除 [html] 内资源, ["+t.msgSpecialKey+"] 内资源需要手动删除"},model:{value:t.deleteAssets,callback:function(e){t.deleteAssets=e},expression:"deleteAssets"}},[t._v("删除资源")]),s("ul",t._l(t.srcArr,(function(e,i){return s("li",{key:i},[s("el-link",{attrs:{href:e,target:"_blank"}},[t._v(t._s(e))]),t.isPic(e)?s("img",{staticStyle:{margin:"0 10px","max-height":"100px","vertical-align":"middle"},attrs:{src:e}}):t._e(),s("el-link",{attrs:{href:t.delSrc(e),title:t.delSrc(e),target:"_blank"}},[s("i",{staticClass:"el-icon-brush"})])],1)})),0),t.deleteAssets?s("div",[0===t.srcArr.length?s("p",{staticClass:"noAssetsInHtml"},[t._v("msg.html 中没有找到可以删除的资源")]):t._e(),t.msgSpecialKey?s("div",[s("el-divider",[t._v("以下 msg."+t._s(t.msgSpecialKey)+" 内资源需要手动删除")]),s("pre",{staticClass:"msgSpecialKeyAssets"},[t._v(t._s(JSON.stringify(t.msg[t.msgSpecialKey],null,4)))])],1):t._e()]):t._e()]:t._e()],t.updateByFileShow?s("UpdateByFile",{attrs:{msg:t.msg},on:{"update:updateByFileShow":function(e){return t.updateByFileShow=e},updateMsgText:t.getMsgTextByFileUpdate}}):t._e()],2):t._e(),s("i",{staticClass:"el-icon-edit",attrs:{slot:"reference"},slot:"reference"})])],1)},n=[],a=s(92196),o=s.n(a),r=s(74549),l=s(95787),c=s(86275),p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("Snippets",{attrs:{snippets:t.currSourceSnippets}}),s("Input",{ref:"input",staticClass:"text",attrs:{rows:t.canDel?1:14,placeholder:"请输入JSON"},model:{value:t.textInner,callback:function(e){t.textInner=e},expression:"textInner"}})],1)},d=[],u=s(89590),m=s(72217),_=t=>[{label:"fillContentByClip",des:"从剪贴板填充 html 和 content 字段",fn:async t=>{const e=await(0,m.getClipboardContents)();return t.content=e,t.html=e,t}},{label:"HtmlToContent",des:"将当前 html 字段内容格式化填充 content 字段",fn:(t,e)=>{if(!e)return null;const s=(0,m.htmlToText)(e.html);return e.content=s,e}},{label:"文件",des:"修改 type 为 [文件], 填充 [文件名] 为 html 和 content 字段",fn:async e=>{const[s,i]=await t.msgBoxPrompt({title:"输入文件信息"});return s?null:(e.type="文件",e.html=i,e.content=i,e)}}],y=s(53943),g=t=>[{label:"qq-video",des:"根据 qq/video 下的文件名自动修改MSG",fn:async e=>{e.type="视频";const[s,i]=await t.msgBoxPrompt({title:"输入视频文件名"});if(s)return null;if(!i)return e.content="",e.html="",null;const{result:n}=await y.Z.get(`/assets/flies/${i}`,{params:{source:e.source,type:e.type}});if(0===n.length||n.length>=3)return(0,r.Message)({type:"error",message:`文件不存在 ${n.join(" | ")}`}),null;let[a="",o=""]=n;o||(o=a);const c="."+a.split(".").pop().toLowerCase();l.fd.includes(c)||((0,r.Message)({type:"error",message:`视频文件不存在 ${a}`}),a="");const p="."+o.split(".").pop().toLowerCase();return l.fQ.includes(p)||((0,r.Message)({type:"error",message:`图片文件不存在 ${o}`}),o=""),e.content="[视频]",e.html=(0,l.Pl)(a,o),e}},{label:"qq-视频通话",fn:t=>(t.type="视频通话",t.content="已在其他设备处理",t.html="已在其他设备处理",t)},{label:"qq-语音",fn:async e=>{e.type="语音";const[s,i]=await t.msgBoxPrompt({title:"输入文件名",message:"./data/qq-pc/audio/manual/"}),[n,a]=await t.msgBoxPrompt({title:"请输入语音内容"}),o=i?`./data/qq-pc/audio/manual/${i}`:"";return e.content="[语音消息]",e.html=`<audio controls src='${o}' ></audio>`,a&&(e.content+=a,e.html+=`<div>${a}</div>`),e}}];const{htmlToText:f}=s(72217),{"is_MobileQQ_Android_type_视频":h,"is_MobileQQ_Android_type_图片":b,"is_MobileQQ_Android_type_混合消息":x}=s(61494),{"MobileQQ_Android_type_图片":v,"MobileQQ_Android_type_自定义表情":M,"MobileQQ_Android_type_消息":Q}=s(3213);var w=t=>[{label:"图->自定义表情",filter:t=>b(t)&&!x(t),fn:async e=>{e.type=M;const s=await A(t);if(!s)return null;const{packName:i,desc:n}=s;let a=e.$MobileQQ.data.imgUrl;return a||(a=await k(t,i),a)?(e.content=`[${i}-${n}]`,e.html=e.content,e.$MobileQQ={os:"Android",data:{webUrl:a,packName:i,desc:n,mark:""}},e):null}},{filter:t=>x(t),label:"混合信息 图->表情",fn:async e=>{const s=o().get(e,"$MobileQQ.data.mixArr"),i=s.filter((t=>t.type===v)).length;if(0===i)return(0,r.Message)({type:"error",message:"没找到图片"}),null;if(1!==i)return(0,r.Message)({type:"error",message:"有多个 图片 不知道修改哪一个 请手动处理"}),null;const n=s.findIndex((t=>t.type===v)),a=await A(t);if(!a)return null;const{packName:l,desc:c}=a,p=s[n];let d=p.data.imgUrl;if(!d&&(d=await k(t,l),!d))return null;const u={type:M,html:`[${l}-${c}]`,data:{webUrl:d,packName:l,desc:c,mark:""}};return s[n]=u,e.html=s.map((t=>t.html)).join("<br/>"),e.content=f(e.html),s.find((t=>t.type===v))?e.type=v:s.find((t=>t.type===M))?e.type=M:e.type=Q,e}},{filter:t=>b(t),label:"补图",fn:async e=>{const[s,i]=await t.msgBoxPrompt({title:"输入图片文件名",message:"./data/qq-android/image/manual/"});return s||!i?null:(o().set(e,"$MobileQQ.data.imgUrl",`./data/qq-android/image/manual/${i}`),e)}},{filter:t=>h(t),label:"补视频",fn:async e=>{const[s,i]=await t.msgBoxPrompt({title:"输入视频文件名",message:"./data/qq-android/video/manual/"});return s||!i?null:(o().set(e,"$MobileQQ.data.videoLocalUrl",`./data/qq-android/video/manual/${i}`),e)}}];async function A(t){const e=/^(.+)-(.+)$/,[s,i]=await t.msgBoxPrompt({title:"输入 [表情包名称-表情描述]",inputValidator:t=>e.test(t)}),n=i.trim();if(s||!n)return null;const[,a,o]=n.match(e);return{packName:a,desc:o}}async function k(t,e){const[s,i]=await t.msgBoxPrompt({title:"输入表情文件名",message:`./data/qq-android/emoticon/${e}/{fileName}`});return s||!i?null:`./data/qq-android/emoticon/${e}/${i}`}const{"Wechat_Android_type_图片":S,"Wechat_Android_type_视频":F}=s(83574);var $=t=>[{label:"wechat-图片",fn:async e=>{e.type=S;const[s,i]=await t.msgBoxPrompt({title:"输入文件名",message:"./data/wechat-manual/image2/"});if(s)return null;const n="./data/wechat-manual/image2/"+i.trim();return e.$Wechat.webData.$imgUrl.unshift(n),e}},{label:"wechat-视频",fn:async e=>{e.type=F;const[s,i]=await t.msgBoxPrompt({title:"输入文件名",message:"./data/wechat-manual/video/"});if(s)return null;const n="./data/wechat-manual/video/"+i.trim();return e.$Wechat.webData.$mp4info.mp4Url=n,e}}];const D=s(92332);var C={mixins:[u.Z],props:{canDel:{require:!0,type:Boolean},msgModify:{type:[Object,String]}},data:()=>({}),computed:{currSourceSnippets(){return this.snippets.filter((t=>!t.filter||t.filter(this.msg)))},snippets(){const t=this;this.replaceKey;return[..._(t),...t.addSnippetFilter(g(t),D.isQQ),...t.addSnippetFilter(w(t),D.isMobileQQ_Android),...t.addSnippetFilter($(t),D.isWechat)].map((e=>(e.fn=t.changeMsg(e.fn),e)))}},methods:{addSnippetFilter(t,e){return t.map((t=>(t.filter||(t.filter=e),t)))},changeMsg(t){return async()=>{const e=await t(o().cloneDeep(this.msg),this.msgModify);e&&(this.textInner=JSON.stringify(e,null,4))}}}},T=C,I=s(1001),P=(0,I.Z)(T,p,d,!1,null,"433cec8c",null),B=P.exports,q=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[0!==t.currTypes.length?s("div",{staticClass:"box"},[s("el-form",{staticClass:"form",attrs:{"label-position":"top"}},[s("el-form-item",{attrs:{label:"类型"}},[s("el-radio-group",{attrs:{disabled:0!==Object.keys(t.tmpUpData).length},model:{value:t.upData.type,callback:function(e){t.$set(t.upData,"type",e)},expression:"upData.type"}},t._l(t.currTypes,(function(e){return s("el-radio",{key:e.type,attrs:{label:e.type}},[t._v(t._s(e.type))])})),1)],1),s("el-form-item",{attrs:{label:"复制文件路径"}},[s("el-input",{staticClass:"input",attrs:{placeholder:"如果填写将从路径 [复制] 文件"},model:{value:t.upData.filePath,callback:function(e){t.$set(t.upData,"filePath","string"===typeof e?e.trim():e)},expression:"upData.filePath"}})],1),t.showFaceForm?s("el-form-item",{attrs:{label:"表情说明"}},[s("el-input",{staticClass:"input",model:{value:t.unknownFace.type,callback:function(e){t.$set(t.unknownFace,"type","string"===typeof e?e.trim():e)},expression:"unknownFace.type"}},[s("template",{slot:"prepend"},[t._v("表情包名称")]),s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(e){t.showDialogFace=!0}},slot:"append"})],2),s("el-input",{staticClass:"input",model:{value:t.unknownFace.alt,callback:function(e){t.$set(t.unknownFace,"alt","string"===typeof e?e.trim():e)},expression:"unknownFace.alt"}},[s("template",{slot:"prepend"},[t._v("表情说明")]),s("el-button",{staticStyle:{float:"right"},attrs:{slot:"append",plain:"",type:"primary"},on:{click:function(e){return t.addFace()}},slot:"append"},[t._v("提交")])],2)],1):t._e()],1),t.upFileImgPreSrc?s("div",{staticClass:"pre"},[s("el-image",{attrs:{src:t.upFileImgPreSrc}}),s("el-divider",[t._v("alias")]),s("el-upload",{ref:"faceAliasUpload",attrs:{"auto-upload":!1,accept:"image/*",action:"#","list-type":"picture-card"}},[s("i",{staticClass:"el-icon-plus"})])],1):s("div",{staticClass:"up",class:{disabled:!t.canUp}},[s("el-upload",{ref:"fileUpload",attrs:{accept:"表情"===t.upData.type?"image/*":"",data:t.updDataMerge,disabled:!t.canUp,"http-request":t.postUpFile,limit:1,action:"#",drag:""}},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text"},[t._v(" 将文件拖到此处，或 "),s("em",[t._v("点击上传")])]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"})])],1)],1):s("el-card",[s("div",[s("span",[t._v(" 当前 "),s("el-link",{attrs:{type:"primary"}},[t._v(t._s(t.msg.source))]),t._v("文件规则还没写呢，先手动修改 HTML 吧。 ")],1),s("i",{staticClass:"el-icon-circle-close",staticStyle:{float:"right",cursor:"pointer",color:"red"},on:{click:function(e){return t.$emit("update:updateByFileShow",!1)}}})])]),t.showDialogFace?[s("DialogFace",{attrs:{show:t.showDialogFace,source:t.upData.source,type:t.upData.type},on:{"update:show":function(e){t.showDialogFace=e},selectFaceType:function(e){return t.unknownFace.type=e}}},[s("el-image",{attrs:{src:t.upFileImgPreSrc}}),s("pre",[t._v(t._s(JSON.stringify(this.tmpUpData.fileInfo,null,4)))])],1)]:t._e()],2)},N=[],O={props:{msg:Object},mounted(){this.upData.source=this.msg.source},data:()=>({types:[{source:"QQ",type:"图片"},{source:"QQ",type:"视频"},{source:"QQ",type:"语音"},{source:"QQ",type:"表情"},{source:"Wechat",type:"表情"}],upData:{source:"",type:"表情",filePath:localStorage.getItem("dev:upData.filePath")||""},showFaceForm:!1,showDialogFace:!1,upFileImgPreSrc:"",unknownFace:{type:"",alt:""},tmpUpData:{}}),computed:{updDataMerge(){return Object.assign(this.upData,{msg:this.msg})},canUp(){return this.upData.type},currTypes(){return this.types.filter((t=>t.source===this.msg.source))}},watch:{imgAliasList:{deep:!0,handler(t){console.log("v",t)}},"upData.filePath"(t){localStorage.setItem("dev:upData.filePath",t)}},methods:{async postUpFile({data:t,file:e}){const{source:s,type:i,msg:n}=t,a=`${s}_${i}`;switch(a){case"QQ_表情":{const s=await this.checkFaceHas(e,t);if(s.face)this.sendMsgText({msg:s.msg,autoSubmit:s.accurateFix});else{this.showFaceForm=!0,this.showDialogFace=!0,await this.$nextTick();const i=await this.fileToImg(e);this.upFileImgPreSrc=i,this.tmpUpData.sendData=t,this.tmpUpData.inputFile=e,this.tmpUpData.fileInfo=s.fileInfo,this.unknownFace.alt=/^\[(.+)\]$/.test(n.content)?n.content.trim().match(/^\[(.+)\]$/)[1].trim():"","图"===this.unknownFace.alt&&(this.unknownFace.alt="")}}break;default:{const{code:s,result:i}=await y.Z.file("/msg/modify/file/add",e,{...t,lastModified:e.lastModified});this.sendMsgText({msg:i.msg,autoSubmit:i.accurateFix})}break}this.$refs.fileUpload.clearFiles()},async checkFaceHas(t,e){const{source:s,type:i,msg:n}=e,{code:a,result:o}=await y.Z.file("/msg/modify/file/face/has",t,e);return o},async addFace(){if(!this.unknownFace.type||!this.unknownFace.alt)return void r.Message.error("表情说明不能为空");const{sendData:t,inputFile:e,fileInfo:s}=this.tmpUpData,i=Object.assign(t,{fileInfo:s,unknownFace:this.unknownFace}),n=this.$refs.faceAliasUpload.uploadFiles;if(0!==n.length){const t=n.map((t=>t.raw)),{result:e}=await y.Z.files("/msg/modify/file/face/alias/add",t,i);0!==e.length&&(s.alias=e),this.$refs.faceAliasUpload.clearFiles()}const{result:a}=await y.Z.file("/msg/modify/file/face/add",e,i);this.sendMsgText({msg:a.msg,autoSubmit:a.accurateFix})},modifyMsgByContentAndHtml(t,e){const s=o().cloneDeep(this.msg);s.content+=t,s.html+=e,this.sendMsgText({msg:s})},sendMsgText({msg:t,autoSubmit:e}){this.$emit("updateMsgText",{msg:JSON.stringify(t,null,4),autoSubmit:e})},fileToImg(t){return new Promise((e=>{const s=new FileReader;s.onloadend=function(t){const s=t.target.result;e(s)},s.readAsDataURL(t)}))}},components:{DialogFace:()=>s.e(5388).then(s.bind(s,95388))}},U=O,E=(0,I.Z)(U,q,N,!1,null,"5e8e0ed6",null),W=E.exports;const{getPublicFileDirByHtml:K,IS_NEED_DELETE_FLAG:j}=s(98803);var Z={mounted(){"Camera"===this.msg.source&&(this.deleteAssets=!0),this.initMsgEdit()},props:{msg:Object},data:()=>({isModify:!1,modifyType:"",visible:!1,loading:!1,deleteAssets:!1,msgText:"",updateByFileShow:!1}),computed:{msgSpecialKey(){return Object.keys(this.msg).find((t=>t.startsWith("$")))},partOfMsg(){return this.msg},canDel(){return""==this.msgText},canModify(){return!o().isEqual(this.partOfMsg,this.msgModify)},msgModify(){try{const t=JSON.parse(this.msgText);return t}catch(t){return""}},isMsgParseOk(){return""!=this.msgModify},srcArr(){return o().uniq(K(this.msg.html))},msgIsNotModify(){return this.msgText===JSON.stringify(this.partOfMsg,null,4)}},methods:{getMsgTextByFileUpdate({msg:t,autoSubmit:e}){this.msgText=t,this.updateByFileShow=!1,e&&this.modifyMsg("modify")},msgChangeDirection(){try{this.msgText=(0,c.u)(this.msgText)}catch(t){r.Message.error("错误"+t.message)}},initMsgEdit(){this.msgText=JSON.stringify(this.partOfMsg,null,4),this.updateByFileShow=!1},modifyMsg(t){let e;switch(this.modifyType=t,t){case"delete":e={type:t,nMsg:this.msg,deleteAssets:this.deleteAssets};break;case"modify":e={type:t,nMsg:Object.assign(o().cloneDeep(this.msg),o().cloneDeep(this.msgModify))};break;default:throw new Error("error type")}this.$store.commit("dev/pushModifyMsg",e),this.visible=!1,this.loading=!1,this.isModify=!0},isPic(t){return l.fQ.some((e=>t.toLowerCase().endsWith(e)))},delSrc(t){const e=t.split(".");return e[e.length-2]+=j,e.join(".")}},components:{MsgHtmlInput:B,UpdateByFile:W}},H=Z,L=(0,I.Z)(H,i,n,!1,null,"21104554",null),J=L.exports},89590:function(t,e,s){"use strict";s.d(e,{Z:function(){return b}});var i=s(74549),n=s(95787),a=s(86275),o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"snippets"},[s("div",t._l(t.snippets,(function(e){return s("el-tag",{key:e.label,staticClass:"tag",attrs:{title:t.titleValue(e),type:e.type||"warning"},on:{click:function(s){return t.clickTag(e)}}},[t._v(t._s(e.label))])})),1),s("hr"),s("div",[t._t("default")],2)])},r=[],l={name:"HTML_INPUT_SNIPPETS",props:{snippets:{require:!0,type:Array,default(){return[]}}},data:()=>({}),methods:{clickTag(t){t.fn?t.fn():this.insertSnippet(t.str||this.simpleElm(t.label))},insertSnippet(...t){this.$parent.insertSnippet(...t)},simpleElm(...t){return this.$parent.simpleElm(...t)},titleValue(t){if(!t.key&&!t.des)return"";const e=t.key?`Ctrl+${t.key}`:"",s=t.des;return e&&s?`${e}\n${s}`:e||s}}},c=l,p=s(1001),d=(0,p.Z)(c,o,r,!1,null,"4cf43ebd",null),u=d.exports,m=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-input",t._g(t._b({ref:"input",attrs:{rows:t.rows,type:"textarea"},on:{focus:function(e){return t.moveCursor()}},nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab")||e.ctrlKey||e.shiftKey||e.altKey||e.metaKey?null:(e.preventDefault(),t.moveCursor())}},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}},"el-input",t.$attrs,!1),t.$listeners))},_=[],y={name:"Dev-Common-HtmlInput-Input",model:{prop:"value",event:"input"},props:{rows:{type:Number,require:!0,default:5},value:String},data:()=>({}),computed:{text:{get(){return this.value},set(t){this.$emit("input",t)}}},methods:{moveCursor(...t){this.$parent.moveCursor(...t)},getInput(){return this.$refs.input.getInput()},focus(){this.$refs.input.focus()}}},g=y,f=(0,p.Z)(g,m,_,!1,null,"6684fe87",null),h=f.exports,b={props:{msg:Object,show:Boolean,text:{require:!0,type:String},canDel:{require:!0,type:Boolean}},data:()=>({replaceKey:n.AP}),computed:{textDefault(){return""},textInner:{get(){return this.text},set(t){this.$emit("update:text",t)}},inputElm(){return this.$refs.input.getInput()}},watch:{show:{immediate:!0,handler(t){t&&this.focus()}}},methods:{async msgBoxPrompt(t={}){const{message:e="",title:s=""}=t,n=`msg-box-prompt-${Date.now()}`,a=i.MessageBox.prompt(e,s,{inputValue:"",confirmButtonText:"确定",cancelButtonText:"取消",customClass:n,...t}).then((({action:t,value:e})=>[null,e.trim()])).catch((t=>((0,i.Message)({type:"info",message:"取消输入"+t.message}),[t])));await this.$nextTick();const o=document.querySelector("."+n);return o.onclick=function(t){t.stopPropagation()},a},insertSnippet(t,e){this.focus(),this.textInner=(0,a.O)(this.inputElm,t,this.textInner,e)},focus(){this.$nextTick((()=>{const t=this.inputElm===document.activeElement;t?this.moveCursor():this.$refs.input.focus()}))},moveCursor(){const t=this.inputElm;this.textInner.trim()||(this.textInner=this.textDefault),this.$nextTick((()=>{const e=t.selectionStart,s=this.textInner,i=s.substr(e),n=i.match(/^<\/[a-zA-Z]{1,7}>/);if(n){const s=e+n[0].length,i=s;return void t.setSelectionRange(s,i)}const a=i.indexOf(this.replaceKey);if(-1!==a){const e=s.length-i.length+a,n=e+this.replaceKey.length;return void t.setSelectionRange(e,n)}const o=s.indexOf(this.replaceKey);if(-1===o);else{const e=o+this.replaceKey.length;t.setSelectionRange(o,e)}}))},simpleElm(t){return`<${t}>${this.replaceKey}</${t}>`}},components:{Snippets:u,Input:h}}},86275:function(t,e,s){"use strict";s.d(e,{O:function(){return o},u:function(){return a}});var i=s(92196),n=s.n(i);function a(t){const e=n().isString(t),s=e?JSON.parse(t):n().cloneDeep(t);s.direction="go"===s.direction?"come":"go";const{sender:i,senderName:a,receiver:o,receiverName:r}=s;return s.sender=o,s.senderName=r,s.receiver=i,s.receiverName=a,e?JSON.stringify(s,null,4):s}function o(t,e,s,i){let n;if(isNaN(i))switch(i){case"end":n=s.length;break;case"start":n=0;break}else n=Number(i);n=n??t.selectionStart;const a=s||t.value;return a.substr(0,n)+e+a.substr(n)}},61494:function(t,e,s){const i=s(92196),{mixRules:n}=s(16275),{isMobileQQ_Android:a}=s(92332),{"MobileQQ_Android_type_消息":o,"MobileQQ_Android_type_系统消息":r,"MobileQQ_Android_type_撤回":l,"MobileQQ_Android_type_动作":c,"MobileQQ_Android_type_位置":p,"MobileQQ_Android_type_图片":d,"MobileQQ_Android_type_分享":u,"MobileQQ_Android_type_自定义表情":m,"MobileQQ_Android_type_视频通话":_,"MobileQQ_Android_type_视频":y,"MobileQQ_Android_type_语音":g,"MobileQQ_Android_type_文件":f,"MobileQQ_Android_type__混合消息":h}=s(3213),b=t=>t.type===o,x=t=>t.type===r,v=t=>t.type===l,M=t=>t.type===c,Q=t=>t.type===p,w=t=>t.type===d,A=t=>t.type===u,k=t=>t.type===m,S=t=>t.type===_,F=t=>t.type===y,$=t=>t.type===g,D=t=>t.type===f,C=t=>i.get(t,"$MobileQQ.type")===h;t.exports=n({"is_MobileQQ_Android_type_消息":b,"is_MobileQQ_Android_type_系统消息":x,"is_MobileQQ_Android_type_撤回":v,"is_MobileQQ_Android_type_动作":M,"is_MobileQQ_Android_type_位置":Q,"is_MobileQQ_Android_type_图片":w,"is_MobileQQ_Android_type_分享":A,"is_MobileQQ_Android_type_自定义表情":k,"is_MobileQQ_Android_type_视频通话":S,"is_MobileQQ_Android_type_视频":F,"is_MobileQQ_Android_type_语音":$,"is_MobileQQ_Android_type_文件":D,"is_MobileQQ_Android_type_混合消息":C},a)},3213:function(t){t.exports["MobileQQ_Android_type_消息"]="消息",t.exports["MobileQQ_Android_type_系统消息"]="系统消息",t.exports["MobileQQ_Android_type_撤回"]="撤回",t.exports["MobileQQ_Android_type_动作"]="动作",t.exports["MobileQQ_Android_type_位置"]="位置",t.exports["MobileQQ_Android_type_图片"]="图片",t.exports["MobileQQ_Android_type_分享"]="分享",t.exports["MobileQQ_Android_type_自定义表情"]="自定义表情",t.exports["MobileQQ_Android_type_视频通话"]="视频通话",t.exports["MobileQQ_Android_type_视频"]="视频",t.exports["MobileQQ_Android_type_语音"]="语音",t.exports["MobileQQ_Android_type_文件"]="文件",t.exports["MobileQQ_Android_type__混合消息"]="_混合消息",t.exports["MobileQQ_Android_type__文本"]="_文本"},83574:function(t){t.exports["Wechat_Android_type_分享"]="分享",t.exports["Wechat_Android_type_红包"]="红包",t.exports["Wechat_Android_type_聊天记录"]="聊天记录",t.exports["Wechat_Android_type_名片"]="名片",t.exports["Wechat_Android_type_视频"]="视频",t.exports["Wechat_Android_type_视频通话"]="视频通话",t.exports["Wechat_Android_type_图片"]="图片",t.exports["Wechat_Android_type_微信运动"]="微信运动",t.exports["Wechat_Android_type_位置"]="位置",t.exports["Wechat_Android_type_位置共享"]="位置共享",t.exports["Wechat_Android_type_文件"]="文件",t.exports["Wechat_Android_type_系统消息"]="系统消息",t.exports["Wechat_Android_type_消息"]="消息",t.exports["Wechat_Android_type_小程序"]="小程序",t.exports["Wechat_Android_type_语音"]="语音",t.exports["Wechat_Android_type_转账"]="转账",t.exports["Wechat_Android_type_自定义表情"]="自定义表情",t.exports["Wechat_Android_type_撤回"]="撤回"},16275:function(t){function e(t,e){return Object.entries(t).forEach((([s,i])=>{t[s]=t=>e(t)&&i(t)})),t}t.exports={mixRules:e}}}]);