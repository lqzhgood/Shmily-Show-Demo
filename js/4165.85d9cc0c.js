"use strict";(self["webpackChunkShmily"]=self["webpackChunkShmily"]||[]).push([[4165],{73104:function(t,e,a){a.r(e),a.d(e,{default:function(){return f}});var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("LoadingDiv",{staticClass:"wrap",attrs:{loading:t.loading}},[a("div",{staticClass:"currYear"},[a("el-tooltip",{attrs:{placement:"right","popper-class":"heatmap-weekAndDay-currYearInfo-tips"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",{staticClass:"o"},[a("span",{staticClass:"key"},[t._v("总计:")]),a("span",{staticClass:"value"},[t._v(t._s(t.currYearInfo.total)+" 条")])]),a("div",{staticClass:"o"},[a("span",{staticClass:"key"},[t._v("最高:")]),a("span",{staticClass:"value"},[t._v(t._s(t.currYearInfo.max)+" 条")])]),t.currYearInfo.maxDays.length>0?[a("div",{staticClass:"o"},[a("span",{staticClass:"key"},[t._v("时间:")])]),a("div",{staticClass:"list"},t._l(t.currYearInfo.maxDays,(function(e){return a("div",{key:e},[t._v(t._s(e))])})),0)]:t._e()],2),a("span",{staticClass:"text"},[t._v(t._s(this.year))])])],1),a("div",{ref:"chart",staticClass:"chart"})])},n=[],i=a(92196),o=a.n(i),r=a(63866),l=a(8206),c=a(19146),p=a(45889),d={name:"Statistic-Components-Plot-Heatmap-Components-WeekAndDay",mixins:[l.Z],data:()=>({currYearInfo:{maxDays:[]}}),props:{heatmapType:{type:String,require:!0,validator(t){return[p.HEATMAP_DB_TYPE_YEAR,p.HEATMAP_DB_TYPE_WEEK,p.HEATMAP_DB_TYPE_DAY].includes(t)}},year:{type:Number,require:!0},maxTypeIsAll:{type:Boolean,require:!0}},computed:{defaultUrl(){return`/statistic/${this.sourceType}/${this.directionType}/heatmap/${this.heatmapType}/${this.year}.json`}},watch:{maxTypeIsAll(){this.$plot.changeMaxTypeIsAll(this.maxTypeIsAll)}},methods:{async updatePlot(){await this.toggleLoading(!0);const t=this.url?`${this.url}/${this.heatmapType}/${this.year}.json`:this.defaultUrl,e=await r.Z.get(t);this.currYearInfo=o().omit(e.data,"data");const a={plot:Object.assign({},this?.plotOptions?.plot),extra:Object.assign({type:this.heatmapType,sourceType:this.sourceType,maxTypeIsAll:this.maxTypeIsAll},this?.plotOptions?.extra)};this.$plot?this.$plot.changeData(e,a):this.$plot=new c.s(this.$refs.chart,e,a),await this.toggleLoading(!1)}}},u=d,h=a(1001),y=(0,h.Z)(u,s,n,!1,null,"388f286c",null),f=y.exports},19146:function(t,e,a){a.d(e,{s:function(){return y}});var s=a(51410),n=a(92196),i=a.n(n),o=a(72217);const r={autoFit:!0,xField:"year",yField:"month",shape:"week-boundary-polygon",meta:{month:{type:"cat",values:["",1,2,3,4,5,6,7,8,9,10,11,12]},day:{type:"cat"},year:{type:"cat"},count:{sync:!0},date:{type:"cat"}},xAxis:{position:"top",tickLine:null,line:null,label:{offset:12,style:{fontSize:12,fill:"#666",textBaseline:"top"}}},yAxis:{grid:null,label:{formatter(t){return t?`${t} 月`:""}}}},l={autoFit:!1,height:140,xField:"week",yField:"weekday",shape:"week-boundary-polygon",meta:{weekday:{type:"cat",values:["周一","周二","周三","周四","周五","周六","周日"]},week:{type:"cat",values:[...new Array(54).keys()].map((t=>String(t)))},count:{sync:!0},date:{type:"cat"}},xAxis:{position:"top",tickLine:null,line:null,label:{autoHide:!1,offset:4,style:{fontSize:12,fill:"#666",textBaseline:"top"},formatter:t=>{let e;if(2==t)e=1;else if(7==t)e=2;else if(11==t)e=3;else if(15==t)e=4;else if(20==t)e=5;else if(24==t)e=6;else if(28==t)e=7;else if(33==t)e=8;else if(37==t)e=9;else if(42==t)e=10;else if(46==t)e=11;else{if(51!=t)return"";e=12}return e+"月"},yAxis:{grid:null}}}},c={autoFit:!1,height:160,xField:"day",yField:"hour",shape:"day-boundary-polygon",meta:{hour:{type:"cat",values:[...new Array(24).keys()]},day:{type:"cat",values:[...new Array(367).keys()].slice(1)},count:{sync:!0},date:{type:"cat"}},xAxis:{position:"top",tickLine:null,line:null,label:{autoHide:!1,offset:4,style:{fontSize:12,fill:"#666",textBaseline:"top"},formatter:t=>t%30==15?Math.ceil(t/30)+"月":""},yAxis:{grid:null}}};var p=a(45889),d=a(49101),u=a(6725);function h(){s.G2.registerShape("polygon","week-boundary-polygon",{draw(t,e){const a=e.addGroup(),s={stroke:"#fff",lineWidth:1,fill:t.color,path:[]},n=t.points,i=[["M",n[0].x,n[0].y],["L",n[1].x,n[1].y],["L",n[2].x,n[2].y],["L",n[3].x,n[3].y],["Z"]];if(s.path=this.parsePath(i),a.addShape("path",{attrs:s}),t.data.lastWeek){const e=[["M",n[2].x,n[2].y],["L",n[3].x,n[3].y]];a.addShape("path",{attrs:{path:this.parsePath(e),lineWidth:3,stroke:"#404040"}}),t.data.lastDay&&a.addShape("path",{attrs:{path:this.parsePath([["M",n[1].x,n[1].y],["L",n[2].x,n[2].y]]),lineWidth:3,stroke:"#404040"}})}return a}}),s.G2.registerShape("polygon","day-boundary-polygon",{draw(t,e){const a=e.addGroup(),s={stroke:"#fff",lineWidth:0,fill:t.color,path:[]},n=t.points,i=[["M",n[0].x,n[0].y],["L",n[1].x,n[1].y],["L",n[2].x,n[2].y],["L",n[3].x,n[3].y],["Z"]];if(s.path=this.parsePath(i),a.addShape("path",{attrs:s}),t.data.lastWeek){const e=[["M",n[2].x,n[2].y],["L",n[3].x,n[3].y]];a.addShape("path",{attrs:{path:this.parsePath(e),lineWidth:1,stroke:"#404040"}}),t.data.lastDay&&a.addShape("path",{attrs:{path:this.parsePath([["M",n[1].x,n[1].y],["L",n[2].x,n[2].y]]),lineWidth:1,stroke:"#404040"}})}return a}})}h();class y extends u.Z{get configExtraDefault(){return{type:null,sourceType:null,maxTypeIsAll:null,showDirection:!0,columns:""}}get configTmpl(){switch(this.configExtra.type){case p.HEATMAP_DB_TYPE_YEAR:return r;case p.HEATMAP_DB_TYPE_WEEK:return l;case p.HEATMAP_DB_TYPE_DAY:return c;default:throw new Error("heatmap type error")}}get max(){const{type:t,maxTypeIsAll:e}=this.configExtra,a=this.db;return t===p.HEATMAP_DB_TYPE_YEAR||e?a.max:a.data.max}get data(){const{type:t}=this.configExtra;return t===p.HEATMAP_DB_TYPE_YEAR?this.db.data:this.db.data.data}get configPlotDefault(){const t=this;return{data:t.data,colorField:"count",color:({count:e})=>{if(0==e)return"#D9D9D9";const a=e/t.max;return f(a)},reflect:"y",tooltip:{title:"date",showMarkers:!1,customContent:(e,a)=>{if(0==a.length)return"";a=a[0];const s=a.data,n=()=>{const t=i().get(s,"direction.go",0),e=i().get(s,"direction.come",0),n=i().get(s,"direction.goP","-"),o=i().get(s,"direction.comeP","-");return(0,d.pV)(s.source,a.color,s.count,e,o,t,n,"<hr />")},o=s.type;let r;if(t.configExtra.sourceType===p.SOURCE_TYPE_TOTAL)r=o.map((({source:e,direction:a,count:s,type:n})=>{const i=n.map((({type:t,count:a,direction:s})=>{const{go:n,come:i,goP:o,comeP:r}=s;return(0,d.HB)(e,t,a,n,o,i,r)})).join(""),{go:o,come:r,goP:l,comeP:c}=a,p=s/t.max,u=f(p);return(0,d.pV)(e,u,s,r,c,o,l,i)})).join("");else{const{source:t}=s;r=o.map((({direction:e,count:a,type:s})=>{const{go:n,come:i,goP:o,comeP:r}=e,l=(0,d.HB)(t,s,a,n,o,i,r);return`<div class="list-item ${t}">${l}</div>`})).join("")}const l=[];return t.configExtra.columns?l.push(t.configExtra.columns):l.push(o.length<=4?"one-columns":"two-columns"),t.configExtra.showDirection||l.push("hiddenDirection"),(0,d.vH)(e,`${n()}${r}`,{moreClass:l.join(" ")})}},interactions:[{type:"element-active"}]}}constructor(t,e,a={}){super(t,e,a),this.plot=this.init(t)}init(t){const e=new s.Heatmap(t,Object.assign(this.configPlot,this.configTmpl));return e.render(),e}changeMaxTypeIsAll(t){this.changeData(this.db,{extra:{maxTypeIsAll:t}})}changeData(t,e={}){this.db=t,this.configPlot=e.plot,this.configExtra=e.extra,this.plot.changeData(this.data)}}function f(t){return t<=.5?(0,o.colorPercentage)("#BAE7FF","#1890FF",t):(0,o.colorPercentage)("#1890FF","#0050B3",t)}},49101:function(t,e,a){a.d(e,{HB:function(){return o},pV:function(){return i},vH:function(){return n}});var s=a(45889);function n(t,e,a={}){const{moreClass:n=""}=a;return`<div class="wrap ${n}">\n                <div class="title">\n                    <b class="year">${t}</b>\n                    <b class="total">总数</b>\n                    <span class="avatar">\n                        <img src="${s.DEFAULT_AVATAR_COME}" title="收-聊天窗左侧"/>\n                    </span>\n                    <span class="avatar">\n                        <img src="${s.DEFAULT_AVATAR_GO}" title="发-聊天窗右侧"/>\n                    </span>\n                </div>\n                <div class="list">${e}</div>\n            </div>`}function i(t,e,a,s,n,i,o,r){return`<div class="list-item ${t}">\n                <div class="row source">\n                    <div class="label">\n                        <span class="marker" style="background: ${e};"></span>\n                        <span class="name"><b>${t}</b></span>\n                    </div>\n                    <div class="count">${a}</div>\n                    <div class="come">${s}</div>\n                    <div class="comeP">${n}<span class="p">%</span></div>\n                    <div class="go">${i}</div>\n                    <div class="goP">${o}<span class="p">%</span></div>\n                </div>\n                ${r}\n            </div>`}function o(t,e,a,s,n,i,o){return`<div class="row type">\n                <div class="label">\n                    <img class="icon" src="/static/icon/type/${t}-${e}.png"/>\n                    <span class="name">${e}:</span>\n                </div>\n                <div class="count">${a}</div>\n                <div class="come">${i}</div>\n                <div class="comeP">${o}<span class="p">%</span></div>\n                <div class="go">${s}</div>\n                <div class="goP">${n}<span class="p">%</span></div>\n            </div>`}},597:function(t,e,a){a.d(e,{v:function(){return u},m:function(){return d}});var s=a(82536),n=a(45889),i=a(95787),o={commentWidth:"240px",color_direction_go:"#51afd0",color_direction_come:"#f273be"};const{color_direction_go:r,color_direction_come:l}=o,c=[n.KEY_ALL,...s].reduce(((t,e,a)=>(t[e]=i.xl[a],t)),{}),p=Object.assign({},c,{come:l,go:r}),d=new Proxy(p,{get(t,e){if(t[e])return t[e];{const t=h(e)%i.xl.length,a=i.xl[t];return i.q7.danger(`没有 ${e} 对应的颜色 ${t}`),console.log(`%c 随机颜色为 ${a}`,`color:${a}`),a}}}),u="CONST_USE_COLOR_MAP";function h(t){let e=0;for(let a=0;a<t.length;a++)e+=t.charCodeAt(a);return e}},82536:function(t){t.exports=JSON.parse('["CallLog","Email","MobileQQ","QQ","SMS","Wechat","Camera"]')}}]);